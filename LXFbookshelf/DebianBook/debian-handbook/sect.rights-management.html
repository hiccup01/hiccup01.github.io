<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>9.3. Managing Rights</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css" /><link rel="stylesheet" media="print" href="Common_Content/css/print.css" type="text/css" /><meta name="generator" content="publican 3.0" /><meta name="package" content="Debian-debian-handbook-6.0-en-US-1.0-1" /><meta name="keywords" content="System boot, Initscripts, SSH, Telnet, Rights, Permissions, Supervision, Inetd, Cron, Backup, Hotplug, PCMCIA, APM, ACPI" /><link rel="home" href="index.html" title="The Debian Administrator's Handbook" /><link rel="up" href="unix-services.html" title="Chapter 9. Unix Services" /><link rel="prev" href="sect.remote-login.html" title="9.2. Remote Login" /><link rel="next" href="sect.administration-interfaces.html" title="9.4. Administration Interfaces" /></head><body><p class="hidden" id="title"><a class="left" href="http://www.debian.org"><img src="Common_Content/images/image_left.png" alt="Product Site" /></a><a class="right" href="http://debian-handbook.info"><img src="Common_Content/images/image_right.png" alt="Documentation Site" /></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="sect.remote-login.html"><strong>Prev</strong></a></li><li class="home">The Debian Administrator's Handbook</li><li class="next"><a accesskey="n" href="sect.administration-interfaces.html"><strong>Next</strong></a></li></ul><div class="section"><div class="titlepage"><div><div><h2 class="title" id="sect.rights-management">9.3. Managing Rights</h2></div></div></div><div class="para"><p></p>
			Linux is definitely a multi-user system, so it is necessary to provide a permission system to control the set of authorized operations on files and directories, which includes all the system resources and devices (on a Unix system, any device is represented by a file or directory). This principle is common to all Unix systems, but a reminder is always useful, especially as there are some interesting and relatively unknown advanced uses.
		</div><a id="idp9092016" class="indexterm"></a><a id="idp9092496" class="indexterm"></a><a id="idp9092976" class="indexterm"></a><a id="idp9093696" class="indexterm"></a><a id="idp9094416" class="indexterm"></a><a id="idp9095136" class="indexterm"></a><div class="para"><p></p>
			Each file or folder has specific permissions for three categories of users:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p></p>
					its owner (symbolized by <code class="literal">u</code> as in “user”);
				</div></li><li class="listitem"><div class="para"><p></p>
					its owner group (symbolized by <code class="literal">g</code> as in “group”), representing all the members of the group;
				</div></li><li class="listitem"><div class="para"><p></p>
					the others (symbolized by <code class="literal">o</code> as in “other”).
				</div></li></ul></div><div class="para"><p></p>
			Three types of rights can be combined:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p></p>
					reading (symbolized by <code class="literal">r</code> as in “read”);
				</div></li><li class="listitem"><div class="para"><p></p>
					writing (or modifying, symbolized by <code class="literal">w</code> as in “write”);
				</div></li><li class="listitem"><div class="para"><p></p>
					executing (symbolized by <code class="literal">x</code> as in “eXecute”).
				</div></li></ul></div><a id="idp9101264" class="indexterm"></a><a id="idp9101744" class="indexterm"></a><a id="idp9102208" class="indexterm"></a><a id="idp9102672" class="indexterm"></a><div class="para"><p></p>
			In the case of a file, these rights are easily understood: read access allows reading the content (including copying), write access allows changing it, and execute access allows you to run it (which will only work if it's a program).
		</div><div class="sidebar fil"><div class="titlepage"><div><div><h6><span class="emphasis"><em>SECURITY</em></span> <code class="literal">setuid</code> and <code class="literal">setgid</code> executables</h6></div></div></div><div class="para"><p></p>
			Two particular rights are relevant to executable files: <code class="literal">setuid</code> and <code class="literal">setgid</code> (symbolized with the letter “s”). Note that we frequently speak of “bit”, since each of these boolean values can be represented by a 0 or a 1. These two rights allow any user to execute the program with the rights of the owner or the group, respectively. This mechanism grants access to features requiring higher level permissions than those you would usually have.
		</div><a id="idp9106184" class="indexterm"></a><a id="idp9106824" class="indexterm"></a><div class="para"><p></p>
			Since a <code class="literal">setuid</code> root program is systematically run under the super-user identity, it is very important to ensure it is secure and reliable. Indeed, a user who would manage to subvert it to call a command of their choice could then impersonate the root user and have all rights on the system.
		</div></div><div class="para"><p></p>
			A directory is handled differently. Read access gives the right to consult the list of its entries (files and directories), write access allows creating or deleting files, and execute access allows crossing through it (especially to go there with the <code class="command">cd</code> command). Being able to cross through a directory without being able to read it gives permission to access the entries therein that are known by name, but not to find them if you do not know that they exist or under what name.
		</div><div class="sidebar fil"><a xmlns="" id="cadre.setgid-dir"></a><div class="titlepage"><div><div><h6><span class="emphasis"><em>SECURITY</em></span> <code class="literal">setgid</code> directory and <span class="emphasis"><em>sticky bit</em></span></h6></div></div></div><div class="para"><p></p>
			The <code class="literal">setgid</code> bit also applies to directories. Any newly-created item in such directories is automaticallly assigned the owner group of the parent directory, instead of inheriting the creator's main group as usual. This setup avoids the user to have to change its main group (with the <code class="command">newgrp</code> command) when working in a file tree shared between several users of the same dedicated group.
		</div><a id="idp9111536" class="indexterm"></a><div class="para"><p></p>
			The “sticky” bit (symbolized by the letter “t”) is a permission that is only useful in directories. It is especially used for temporary directories where everybody have write access (such as <code class="filename">/tmp/</code>): it restricts deletion of files so that only their owner (or the owner of the parent directory) can do it. Lacking this, everyone could delete other users' files in <code class="filename">/tmp/</code>.
		</div></div><div class="para"><p></p>
			Three commands control the permissions associated with a file:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p></p>
					<code class="command">chown <em class="replaceable"><code>user</code></em> <em class="replaceable"><code>file</code></em></code> changes the owner of the file;
				</div></li><li class="listitem"><div class="para"><p></p>
					<code class="command">chgrp <em class="replaceable"><code>group</code></em> <em class="replaceable"><code>file</code></em></code> alters the owner group;
				</div></li><li class="listitem"><div class="para"><p></p>
					<code class="command">chmod <em class="replaceable"><code>rights</code></em> <em class="replaceable"><code>file</code></em></code> changes the permissions for the file.
				</div></li></ul></div><div class="para"><p></p>
			There are two ways of presenting rights. Among them, the symbolic representation is probably the easiest to understand and remember. It involves the letter symbols mentioned above. You can define rights for each category of users (<code class="literal">u</code>/<code class="literal">g</code>/<code class="literal">o</code>), by setting them explicitly (with <code class="literal">=</code>), by adding (<code class="literal">+</code>), or subtracting (<code class="literal">-</code>). Thus the <code class="literal">u=rwx,g+rw,o-r</code> formula gives the owner read, write, and execute rights, adds read and write rights for the owner group, and removes read rights for other users. Rights not altered by the addition or subtraction in such a command remain unmodified. The letter <code class="literal">a</code>, for “all”, covers all three categories of users, so that <code class="literal">a=rx</code> grants all three categories the same rights (read and execute, but not write).
		</div><a id="idp9119960" class="indexterm"></a><a id="idp9120520" class="indexterm"></a><a id="idp9121080" class="indexterm"></a><a id="idp9121640" class="indexterm"></a><a id="idp9122144" class="indexterm"></a><a id="idp9122648" class="indexterm"></a><div class="para"><p></p>
			The (octal) numeric representation associates each right with a value: 4 for read, 2 for write, and 1 for execute. We associate each combination of rights with the sum of the figures. Each value is then assigned to different categories of users by putting them end to end in the usual order (owner, group, others).
		</div><div class="para"><p></p>
			For instance, the <code class="command">chmod 754 <em class="replaceable"><code>file</code></em></code> command will set the following rights: read, write and execute for the owner (since 7 = 4 + 2 + 1); read and execute for the group (since 5 = 4 + 1); read-only for others. The <code class="literal">0</code> means no rights; thus <code class="command">chmod 600 <em class="replaceable"><code>file</code></em></code> allows for read/write rights for the owner, and no rights for anyone else. The most frequent right combinations are <code class="literal">755</code> for executable files and directories, and <code class="literal">644</code> for data files.
		</div><div class="para"><p></p>
			To represent special rights, you can prefix a fourth digit to this number according to the same principle, where the <code class="literal">setuid</code>, <code class="literal">setgid</code> and <code class="literal">sticky</code> bits are 4, 2 and 1, respectively. <code class="command">chmod 4754</code> will associate the <code class="literal">setuid</code> bit with the previously described rights.
		</div><div class="para"><p></p>
			Note that the use of octal notation only allows to set all the rights at once on a file; you can not use it to simply add a new right, such as read access for the group owner, since you must take into account the existing rights and compute the new corresponding numerical value.
		</div><div class="sidebar"><div class="titlepage"><div><div><h6><span class="emphasis"><em>TIP</em></span> Recursive operation</h6></div></div></div><div class="para"><p></p>
			Sometimes we have to change rights for an entire file tree. All the commands above have a <code class="literal">-R</code> option to operate recursively in sub-directories.
		</div><div class="para"><p></p>
			The distinction between directories and files sometimes causes problems with recursive operations. That's why the “X” letter has been introduced in the symbolic representation of rights. It represents a right to execute which applies only to directories (and not to files lacking this right). Thus, <code class="command">chmod -R a+X <em class="replaceable"><code>directory</code></em></code> will only add execute rights for all categoties of users (<code class="literal">a</code>) for all of the sub-directories and files for which at least one category of user (even if their sole owner) already has execute rights.
		</div></div><div class="sidebar"><div class="titlepage"><div><div><h6><span class="emphasis"><em>TIP</em></span> Changing the user and group</h6></div></div></div><div class="para"><p></p>
			Frequently you want to change the group of a file at the same time that you change the owner. The <code class="command">chown</code> command has a special syntax for that: <code class="command">chown <em class="replaceable"><code>user</code></em>:<em class="replaceable"><code>group</code></em></code>
		</div></div><div class="sidebar fil"><div class="titlepage"><div><div><h6><span class="emphasis"><em>GOING FURTHER</em></span> <code class="command">umask</code></h6></div></div></div><div class="para"><p></p>
			When an application creates a file, it assigns indicative permissions, knowing that the system automatically removes certain rights, given by the command <code class="command">umask</code>. Enter <code class="command">umask</code> in a shell; you will see a mask such as <code class="computeroutput">0022</code>. This is simply an octal representation of the rights to be systematically removed (in this case, the write right for the group and other users).
		</div><a id="idp9134288" class="indexterm"></a><a id="idp10338176" class="indexterm"></a><a id="idp10338896" class="indexterm"></a><div class="para"><p></p>
			If you give it a new octal value, the <code class="command">umask</code> command modifies the mask. Used in a shell initialization file (for example, <code class="filename">~/.bash_profile</code>), it will effectively change the default mask for your work sessions.
		</div></div></div><div id="site_footer"></div><script type="text/javascript">
		$("#site_footer").load("../../../../../footer.html");
	</script><ul class="docnav"><li class="previous"><a accesskey="p" href="sect.remote-login.html"><strong>Prev</strong>9.2. Remote Login</a></li><li class="up"><a accesskey="u" href="#"><strong>Up</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Home</strong></a></li><li class="next"><a accesskey="n" href="sect.administration-interfaces.html"><strong>Next</strong>9.4. Administration Interfaces</a></li></ul></body></html>
