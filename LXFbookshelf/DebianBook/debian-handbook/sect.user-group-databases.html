<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>8.4. User and Group Databases</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css" /><link rel="stylesheet" media="print" href="Common_Content/css/print.css" type="text/css" /><meta name="generator" content="publican 3.0" /><meta name="package" content="Debian-debian-handbook-6.0-en-US-1.0-1" /><meta name="keywords" content="Configuration, Localization, Locales, Network, Name resolution, Users, Groups, Accounts, Command-line interpreter, Shell, Printing, Bootloader, Kernel compiling" /><link rel="home" href="index.html" title="The Debian Administrator's Handbook" /><link rel="up" href="basic-configuration.html" title="Chapter 8. Basic Configuration: Network, Accounts, Printing..." /><link rel="prev" href="sect.hostname-name-service.html" title="8.3. Setting the Hostname and Configuring the Name Service" /><link rel="next" href="sect.creating-accounts.html" title="8.5. Creating Accounts" /></head><body><p class="hidden" id="title"><a class="left" href="http://www.debian.org"><img src="Common_Content/images/image_left.png" alt="Product Site" /></a><a class="right" href="http://debian-handbook.info"><img src="Common_Content/images/image_right.png" alt="Documentation Site" /></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="sect.hostname-name-service.html"><strong>Prev</strong></a></li><li class="home">The Debian Administrator's Handbook</li><li class="next"><a accesskey="n" href="sect.creating-accounts.html"><strong>Next</strong></a></li></ul><div class="section"><div class="titlepage"><div><div><h2 class="title" id="sect.user-group-databases">8.4. User and Group Databases</h2></div></div></div><a id="idp9604448" class="indexterm"></a><a id="idp9605168" class="indexterm"></a><a id="idp9605888" class="indexterm"></a><a id="idp9606608" class="indexterm"></a><div class="para"><p></p>
			The list of users is usually stored in the <code class="filename">/etc/passwd</code> file, while the <code class="filename">/etc/shadow</code> file stores encrypted passwords. Both are text files, in a relatively simple format, which can be read and modified with a text editor. Each user is listed there on a line with several fields separated with a colon (“<code class="literal">:</code>”).
		</div><div class="sidebar fil"><div class="titlepage"><div><div><h6><span class="emphasis"><em>NOTE</em></span> Editing system files</h6></div></div></div><div class="para"><p></p>
			The system files mentioned in this chapter are all plain text files, and can be edited with a text editor. Considering their importance to core system functionality, it is always a good idea to take extra precautions when editing system files. First, always make a copy or backup of a system file before opening or altering it. Second, on servers or machines where more than one person could potentially access the same file at the same time, take extra steps to guard against file corruption.
		</div><div class="para"><p></p>
			For this purpose, it is enough to use the <code class="command">vipw</code> command to edit the <code class="filename">/etc/passwd</code> file, or <code class="command">vigr</code> to edit <code class="filename">/etc/group</code>. These commands lock the file in question prior to running the text editor, (<code class="command">vi</code> by default, unless the <code class="varname">EDITOR</code> environment variable has been altered). The <code class="literal">-s</code> option in these commands allows editing the corresponding <span class="foreignphrase"><em class="foreignphrase">shadow</em></span> file.
		</div></div><div class="sidebar"><div class="titlepage"><div><div><h6><span class="emphasis"><em>BACK TO BASICS</em></span> Crypt, a one-way function</h6></div></div></div><a id="idp9612880" class="indexterm"></a><div class="para"><p></p>
			<code class="command">crypt</code> is a one-way function that transforms a string <code class="varname">(A)</code> into another string <code class="varname">(B)</code> in a way that <code class="varname">A</code> cannot be derived from <code class="varname">B</code>. The only way to identify <code class="varname">A</code> is to test all possible values, checking each one to determine if transformation by the function will produce <code class="varname">B</code> or not. It uses up to 8 characters as input (string <code class="varname">A</code>) and generates a string of 13, printable, ASCII characters (string <code class="varname">B</code>).
		</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title" id="section.etc-passwd">8.4.1. User List: <code class="filename">/etc/passwd</code></h3></div></div></div><div class="para"><p></p>
				Here is the list of fields in the <code class="filename">/etc/passwd</code> file:
			</div><a id="idp9617192" class="indexterm"></a><a id="idp9617752" class="indexterm"></a><a id="idp9618312" class="indexterm"></a><a id="idp9618872" class="indexterm"></a><a id="idp9619432" class="indexterm"></a><a id="idp9619992" class="indexterm"></a><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p></p>
						login, for example <code class="literal">rhertzog</code>;
					</div></li><li class="listitem"><div class="para"><p></p>
						password: this is a password encrypted by a one-way function, either <code class="command">crypt</code> or <code class="command">md5</code>. The special value “<code class="literal">x</code>” indicates that the encrypted password is stored in <code class="filename">/etc/shadow</code>;
					</div></li><li class="listitem"><div class="para"><p></p>
						<code class="literal">uid</code>: unique number identifying each user;
					</div></li><li class="listitem"><div class="para"><p></p>
						<code class="literal">gid</code>: unique number for the user's main group (Debian creates a specific group for each user by default);
					</div></li><li class="listitem"><div class="para"><p></p>
						<code class="literal">GECOS</code>: data field usually containing the user's full name;
					</div></li><li class="listitem"><div class="para"><p></p>
						login directory, assigned to the user for storage of their personal files (the environment variable <code class="varname">$HOME</code> generally points here);
					</div></li><li class="listitem"><div class="para"><p></p>
						program to execute upon login. This is usually a command interpreter (shell), giving the user free reign. If you specify <code class="command">/bin/false</code> (which does nothing and returns control immediately), the user can not login.
					</div></li></ul></div><div class="sidebar"><div class="titlepage"><div><div><h6><span class="emphasis"><em>BACK TO BASICS</em></span> Unix group</h6></div></div></div><a id="idp9627672" class="indexterm"></a><div class="para"><p></p>
				A Unix group is an entity including several users so that they can easily share files using the integrated permission system (by having precisely the same rights). You can also restrict use of certain programs to a specific group.
			</div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title" id="section.etc-shadow">8.4.2. The Hidden and Encrypted Password File: <code class="filename">/etc/shadow</code></h3></div></div></div><a id="idp9629464" class="indexterm"></a><a id="idp9630024" class="indexterm"></a><div class="para"><p></p>
				The <code class="filename">/etc/shadow</code> file contains the following fields:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p></p>
						login
					</div></li><li class="listitem"><div class="para"><p></p>
						encrypted password;
					</div></li><li class="listitem"><div class="para"><p></p>
						several fields managing password expiration.
					</div></li></ul></div><div class="sidebar"><div class="titlepage"><div><div><h6><span class="emphasis"><em>DOCUMENTATION</em></span> <code class="filename">/etc/passwd</code>, <code class="filename">/etc/shadow</code> and <code class="filename">/etc/group</code> file formats</h6></div></div></div><div class="para"><p></p>
				These formats are documented in the following man pages: <span class="citerefentry"><span class="refentrytitle">passwd</span>(5)</span>, <span class="citerefentry"><span class="refentrytitle">shadow</span>(5)</span>, and <span class="citerefentry"><span class="refentrytitle">group</span>(5)</span>.
			</div></div><div class="sidebar fil"><div class="titlepage"><div><div><h6><span class="emphasis"><em>SECURITY</em></span> <code class="filename">/etc/shadow</code> file security</h6></div></div></div><div class="para"><p></p>
				<code class="filename">/etc/shadow</code>, unlike its alter-ego, <code class="filename">/etc/passwd</code>, cannot be read by regular users. Any encrypted password stored in <code class="filename">/etc/passwd</code> is readable by anybody; a cracker could try to “break” (or reveal) a password by one of several “brute force” methods which, simply put, guess at commonly used combinations of characters. This attack — called a "dictionary attack" — is no longer possible on systems using <code class="filename">/etc/shadow</code>.
			</div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title" id="section.modifier-compte">8.4.3. Modifying an Existing Account or Password</h3></div></div></div><a id="idp9639120" class="indexterm"></a><a id="idp9639680" class="indexterm"></a><a id="idp9640240" class="indexterm"></a><a id="idp9640800" class="indexterm"></a><a id="idp9641360" class="indexterm"></a><div class="para"><p></p>
				The following commands allow modification of the information stored in specific fields of the user databases: <code class="command">passwd</code> permits a regular user to change their password, which in turn, updates the <code class="filename">/etc/shadow</code> file; <code class="command">chfn</code> (CHange Full Name), reserved for the super-user (root), modifies the <code class="literal">GECOS</code> field. <code class="command">chsh</code> (CHange SHell) allows the user to change their login shell, however available choices will be limited to those listed in <code class="filename">/etc/shells</code>; the administrator, on the other hand, is not bound by this restriction and can set the shell to any program of their choosing.
			</div><div class="para"><p></p>
				Finally, the <code class="command">chage</code> (CHange AGE) command allows the administrator to change the password expiration settings (the <code class="literal">-l <em class="replaceable"><code>user</code></em></code> option will list the current settings). You can also force the expiration of a password using the <code class="command">passwd -e <em class="replaceable"><code>user</code></em></code> command, which will require the user to change their password the next time they log in.
			</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title" id="section.bloquer-compte">8.4.4. Disabling an Account</h3></div></div></div><a id="idp9646128" class="indexterm"></a><a id="idp9646592" class="indexterm"></a><div class="para"><p></p>
				You may find yourself needing to “disable an account” (lock out a user), as a disciplinary measure, for the purposes of an investigation, or simply in the event of a prolonged or definitive absence of a user. A disabled account means the user cannot login or gain access to the machine. The account remains intact on the machine and no files or data are deleted; it is simply inaccessible. This is accomplished by using the command <code class="command">passwd -l <em class="replaceable"><code>user</code></em></code> (lock). Re-enabling the account is done in similar fashion, with the <code class="literal">-u</code> option (unlock).
			</div><div class="sidebar"><a xmlns="" id="cadre.intro-nss"></a><div class="titlepage"><div><div><h6><span class="emphasis"><em>GOING FURTHER</em></span> NSS and system databases</h6></div></div></div><a id="idp9649336" class="indexterm"></a><a id="idp9649816" class="indexterm"></a><div class="para"><p></p>
				Instead of using the usual files to manage lists of users and groups, you could use other types of databases, such as LDAP or <code class="command">db</code>, by using an appropriate NSS (Name Service Switch) module. The modules used are listed in the <code class="filename">/etc/nsswitch.conf</code> file, under the <code class="literal">passwd</code>, <code class="literal">shadow</code> and <code class="literal">group</code> entries. See <a class="xref" href="sect.ldap-directory.html#section.config-nss">Section 11.7.3.1, “Configuring NSS”</a> for a specific example of the use of an NSS module by LDAP.
			</div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title" id="section.etc-group">8.4.5. Group List: <code class="filename">/etc/group</code></h3></div></div></div><div class="para"><p></p>
				Groups are listed in the <code class="filename">/etc/group</code> file, a simple textual database in a format similar to that of the <code class="filename">/etc/passwd</code> file, with the following fields:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p></p>
						group name
					</div></li><li class="listitem"><div class="para"><p></p>
						password (optional): This is only used to join a group when one is not a usual member (with the <code class="command">newgrp</code> or <code class="command">sg</code> commands, see sidebar);
					</div></li><li class="listitem"><div class="para"><p></p>
						<code class="literal">gid</code>: unique group identification number
					</div></li><li class="listitem"><div class="para"><p></p>
						list of members: list of names of users who are members of the group, separated by commas.
					</div></li></ul></div><div class="para"><p></p>
			</div><div class="sidebar fil"><div class="titlepage"><div><div><h6><span class="emphasis"><em>BACK TO BASICS</em></span> Working with several groups</h6></div></div></div><a id="idp9657872" class="indexterm"></a><a id="idp9658432" class="indexterm"></a><a id="idp9658992" class="indexterm"></a><a id="idp9659552" class="indexterm"></a><div class="para"><p></p>
				Each user may be a member of many groups; one of them is their “main group”. A user's main group is, by default, created during initial user configuration. By default, each file that a user creates belongs to them, as well as to their main group. This is not always desirable; for example, when the user needs to work in a directory shared by a group other than their main group. In this case, the user needs to change their main group using one of the following commands: <code class="command">newgrp</code>, which starts a new shell, or <code class="command">sg</code>, which simply executes a command using the supplied alternate group. These commands also allow the user to join a group to which they do not belong. If the group is password protected, they will need to supply the appropriate password before the command is executed.
			</div><div class="para"><p></p>
				Alternatively, the user can set the <code class="literal">setgid</code> bit on the directory, which causes files created in that directory to automatically belong to the correct group. For more details, see sidebar <a class="xref" href="sect.rights-management.html#cadre.setgid-dir"><span class="emphasis"><em>SECURITY</em></span> <code class="literal">setgid</code> directory and <span class="emphasis"><em>sticky bit</em></span></a>.
			</div><div class="para"><p></p>
				The <code class="command">id</code> command displays the current state of a user, with their personal identifier (<code class="varname">uid</code> variable), current main group (<code class="varname">gid</code> variable), and the list of groups to which they belong (<code class="varname">groups</code> variable).
			</div></div><a id="idp9664056" class="indexterm"></a><a id="idp9664616" class="indexterm"></a><div class="para"><p></p>
				The <code class="command">groupadd</code> and <code class="command">groupdel</code> commands add or delete a group, respectively. The <code class="command">groupmod</code> command modifies a group's information (its <code class="literal">gid</code> or identifier). The command <code class="command">passwd -g <em class="replaceable"><code>group</code></em></code> changes the password for the group, while the <code class="command">passwd -r -g <em class="replaceable"><code>group</code></em></code> command deletes it.
			</div><a id="idp9667288" class="indexterm"></a><a id="idp9667848" class="indexterm"></a><a id="idp9668408" class="indexterm"></a><a id="idp9668968" class="indexterm"></a><a id="idp9669688" class="indexterm"></a><a id="idp9670408" class="indexterm"></a><a id="idp9671128" class="indexterm"></a><div class="sidebar"><div class="titlepage"><div><div><h6><span class="emphasis"><em>TIP</em></span> <code class="command">getent</code></h6></div></div></div><a id="idp9672312" class="indexterm"></a><div class="para"><p></p>
				The <code class="command">getent</code> (get entries) command checks the system databases the standard way, using the appropriate library functions, which in turn call the NSS modules configured in the <code class="filename">/etc/nsswitch.conf</code> file. The command takes one or two arguments: the name of the database to check, and a possible search key. Thus, the command <code class="command">getent passwd rhertzog</code> will give the information from the user database regarding the user <code class="literal">rhertzog</code>.
			</div></div></div></div><div id="site_footer"></div><script type="text/javascript">
		$("#site_footer").load("../../../../../footer.html");
	</script><ul class="docnav"><li class="previous"><a accesskey="p" href="sect.hostname-name-service.html"><strong>Prev</strong>8.3. Setting the Hostname and Configuring the Nam...</a></li><li class="up"><a accesskey="u" href="#"><strong>Up</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Home</strong></a></li><li class="next"><a accesskey="n" href="sect.creating-accounts.html"><strong>Next</strong>8.5. Creating Accounts</a></li></ul></body></html>
