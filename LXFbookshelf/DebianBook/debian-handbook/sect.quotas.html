<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>9.9. Quotas</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css" /><link rel="stylesheet" media="print" href="Common_Content/css/print.css" type="text/css" /><meta name="generator" content="publican 3.0" /><meta name="package" content="Debian-debian-handbook-6.0-en-US-1.0-1" /><meta name="keywords" content="System boot, Initscripts, SSH, Telnet, Rights, Permissions, Supervision, Inetd, Cron, Backup, Hotplug, PCMCIA, APM, ACPI" /><link rel="home" href="index.html" title="The Debian Administrator's Handbook" /><link rel="up" href="unix-services.html" title="Chapter 9. Unix Services" /><link rel="prev" href="sect.asynchronous-task-scheduling-anacron.html" title="9.8. Scheduling Asynchronous Tasks: anacron" /><link rel="next" href="sect.backup.html" title="9.10. Backup" /></head><body><p class="hidden" id="title"><a class="left" href="http://www.debian.org"><img src="Common_Content/images/image_left.png" alt="Product Site" /></a><a class="right" href="http://debian-handbook.info"><img src="Common_Content/images/image_right.png" alt="Documentation Site" /></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="sect.asynchronous-task-scheduling-anacron.html"><strong>Prev</strong></a></li><li class="home">The Debian Administrator's Handbook</li><li class="next"><a accesskey="n" href="sect.backup.html"><strong>Next</strong></a></li></ul><div class="section"><div class="titlepage"><div><div><h2 class="title" id="sect.quotas">9.9. Quotas</h2></div></div></div><a id="idp11098504" class="indexterm"></a><div class="para"><p></p>
			The quota system allows limiting disk space allocated to a user or group of users. To set it up, you must have a kernel that supports it (compiled with the <code class="varname">CONFIG_QUOTA</code> option) — as is the case of Debian kernels. The quota management software is found in the <span class="pkg pkg">quota</span> Debian package.
		</div><div class="para"><p></p>
			To activate them in a filesystem, you have to indicate the <code class="literal">usrquota</code> and <code class="literal">grpquota</code> options in <code class="filename">/etc/fstab</code> for the user and group quotas, respectively. Rebooting the computer will then update the quotas in the absence of disk activity (a necessary condition for proper accounting of already used disk space).
		</div><div class="para"><p></p>
			The <code class="command">edquota <em class="replaceable"><code>user</code></em></code> (or <code class="command">edquota -g <em class="replaceable"><code>group</code></em></code>) command allows you to change the limits while examining current disk space usage.
		</div><a id="idp11102384" class="indexterm"></a><div class="sidebar fil"><div class="titlepage"><div><div><h6><span class="emphasis"><em>GOING FURTHER</em></span> Defining quotas with a script</h6></div></div></div><a id="idp11103664" class="indexterm"></a><div class="para"><p></p>
			The <code class="command">setquota</code> program can be used in a script to automatically change many quotas. Its <span class="citerefentry"><span class="refentrytitle">setquota</span>(8)</span> manual page details the syntax to use.
		</div></div><div class="para"><p></p>
			The quota system allows you to set four limits:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p></p>
					two limits (called “soft” and “hard”) refer to the number of blocks consumed. If the filesystem was created with a block-size of 1 kilobyte, a block contains 1024 bytes from the same file. Unsaturated blocks thus induce losses of disk space. A quota of 100 blocks, which theoretically allows storage of 102,400 bytes, will however be saturated with just 100 files of 500 bytes each, only representing 50,000 bytes in total.
				</div></li><li class="listitem"><div class="para"><p></p>
					two limits (soft and hard) refer to the number of inodes used. Each file occupies at least one inode to store information about it (permissions, owner, timestamp of last access, etc.). It is thus a limit on the number of user files.
				</div></li></ul></div><div class="para"><p></p>
			A “soft” limit can be temporarily exceeded; the user will simply be warned that they are exceeding the quota by the <code class="command">warnquota</code> command, which is usually invoked by <code class="command">cron</code>. A “hard” limit can never be exceeded: the system will refuse any operation that will cause a hard quota to be exceeded.
		</div><div class="sidebar"><div class="titlepage"><div><div><h6><span class="emphasis"><em>VOCABULARY</em></span> Blocks and inodes</h6></div></div></div><a id="idp11109088" class="indexterm"></a><a id="idp11109552" class="indexterm"></a><div class="para"><p></p>
			The filesystem divides the hard drive into blocks — small contiguous areas. The size of these blocks is defined during creation of the filesystem, and generally varies between 1 and 8 kilobytes.
		</div><div class="para"><p></p>
			A block can be used either to store the real data of a file, or for meta-data used by the filesystem. Among this meta-data, you will especially find the inodes. An inode uses a block on the hard drive (but this block is not taken into consideration in the block quota, only in the inode quota), and contains both the information on the file to which it corresponds (name, owner, permissions, etc.) and the pointers to the data blocks that are actually used. For very large files that occupy more blocks than it is possible to reference in a single inode, there is an indirect block system; the inode references a list of blocks that do not directly contain data, but another list of blocks.
		</div></div><a id="idp11111472" class="indexterm"></a><div class="para"><p></p>
			With the <code class="command">edquota -t</code> command, you can define a maximum authorized “grace period” within which a soft limit may be exceeded. After this period, the software limit will be treated like a hard limit, and the user will have to reduce their disk space usage to within this limit in order to be able to write anything to the hard drive.
		</div><div class="sidebar fil"><div class="titlepage"><div><div><h6><span class="emphasis"><em>GOING FURTHER</em></span> Setting up a default quota for new users</h6></div></div></div><div class="para"><p></p>
			To automatically setup a quota for new users, you have to configure a template user (with <code class="command">edquota</code> or <code class="command">setquota</code>) and indicate their user name in the <code class="varname">QUOTAUSER</code> variable in the <code class="filename">/etc/adduser.conf</code> file. This quota configuration will then be automatically applied to each new user created with the <code class="command">adduser</code> command.
		</div></div></div><div id="site_footer"></div><script type="text/javascript">
		$("#site_footer").load("../../../../../footer.html");
	</script><ul class="docnav"><li class="previous"><a accesskey="p" href="sect.asynchronous-task-scheduling-anacron.html"><strong>Prev</strong>9.8. Scheduling Asynchronous Tasks: anacron</a></li><li class="up"><a accesskey="u" href="#"><strong>Up</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Home</strong></a></li><li class="next"><a accesskey="n" href="sect.backup.html"><strong>Next</strong>9.10. Backup</a></li></ul></body></html>
